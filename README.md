# face_eye_tracking

##　集中度の公式

$$
C = wc_1 + (1-wc_2)\\
\begin{aligned}
c_1: 頻度に変換し正規化した瞬き集中度\\
c_2: 頻度に変換し正規化した顔の動き集中度\\
w:  正面からの角度\\
画面外に出たらwを最大にする
\end{aligned}
$$

##　頻度の式

* 回数/時間
* 1分間のデータを5秒おきの頻度に変換するためn*1/12

## 正規化の式

* (list[i] - max(list)) / (min(list) - max(list)
$$
\sum_{i=0}^{n}\frac{i-max(list)}{min(list)-max(list)}
$$
## wの式

* w = 0 (r = 0, p = 0, y = 0)
* w = 1 - ((r/tr + p/tp + y/ty) / 3)
* r: roll
* p: pitch
* y: yaw
* tn: nの閾値
* r,p,yは動画の1フレーム目でキャリブレーション

## 瞬きの閾値決めの式
* 閾値 = 開眼度の平均 - 標準偏差 - 0.05

## 開眼度の式
* (||p2-p6||+||p3-p5||) / (2||p1-p4||)

## アンケート
* アンケート内容
  * どのくらい動画に興味・関心を持ちましたか？ 1〜5段階Ç

## 実験方法
* 動画を見ながらE-learningもどきをする
* ただE-learningをする
* どの程度差が開くか実験

## 実験手順
* キャリブレーションの動画を各1分間録画する
    1. 青い画面（用意するかは別として）を見て動かずにいてもらう
    2. 赤い画面と何か動くもの（用意するかは別として）を見て動くものを追ってもらう
* 問題を解いてもらう
    1. 集中して普通に問題を解いてもらう
    2. 動画を見ながら問題を解いてもらう
    
## 評価方法
* どの程度集中できたか自己評価アンケート
* 問題への回答時間・正答率で評価
  
## 生成するjson
* 〰cv.json
  * 1フレーム枚の情報を画像から抜き出した未加工データ
* 〰conc.json
  * 5秒おきのデータに加工して出した集中度のデータ
  
## 問題の用意
### 5分ぐらいで終わるのが条件
* 足し算

## 論文にかける文句
* タブレットとかが最近教育で導入されてる
    * タブレットでe-learning中に集中度を測るのはタブレット一つで回答とメモと集中度をまとめて取れる点で有用ではないか？
* 笑うとエクボが上がって瞬き判定になる

## 最終的に使ったファイル

* test_calibrationでred, blueをcalibration
* test_face_muki6で集中度検出

#　実験の方法

##　キャリブレーションする場合

1. キャリブレーション(青)と名前を入力して決定を押す
1. 背景が青いページが開く
1. ページを戻して，1分で終わるを選択，スタートを押す
1. ページを戻して，青い画面に戻りひたすら真ん中を見る
1. 1分後に動画がダウンロードされる
1. ページを戻してキャリブレーション(青)と名前を入力して決定を押す
1. ページを戻して，1分で終わるを選択，スタートを押す
1. ページを戻して，赤い丸を首から追う
1. 1分後に動画がダウンロードされる

## 集中した状態でやる場合

1. 集中と名前を入力して決定を押す
1. googleformが開く
1. ページを戻し，スタートを押す
1. googleformに移動し，集中して問題を解く
1. googleform送信後，ページを戻してストップを押す

## 動画を見ながらやる場合

1. 動画見ながらと名前を入力して決定を押す
1. googleformが開く
1. 見る動画を上画面に用意し，再生する
1. ページを戻し，スタートを押す
1. googleformに移動し，動画を見ながら問題を解く
1. googleform送信後，ページを戻してストップを押す

## スマホゲームをしながらやる場合

1. ゲームをしながらと名前を入力して決定を押す
1. googleformが開く
1. やるゲームを手元に用意する
1. ページを戻し，スタートを押す
1. googleformに移動し，ゲームしながら問題を解く
1. googleform送信後，ページを戻してストップを押す
